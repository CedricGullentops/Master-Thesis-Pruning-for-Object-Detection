#!/usr/bin/env python
import torch
import lightnet as ln

tensor1 = torch.tensor([[[ 0.0207,  0.0039, -0.0284],
         [ 0.0378,  0.0086, -0.0460],
         [ 0.0337,  0.0003, -0.0367]],

        [[ 0.0213,  0.0048, -0.0261],
         [ 0.0397,  0.0101, -0.0513],
         [ 0.0305,  0.0014, -0.0363]],

        [[ 0.0069,  0.0016, -0.0073],
         [ 0.0100,  0.0069, -0.0162],
         [ 0.0096,  0.0030, -0.0137]]], device='cuda:0')

tensor2 = torch.tensor([[[-0.0213, -0.0229, -0.0160],
         [-0.0227, -0.0164, -0.0148],
         [-0.0159, -0.0136, -0.0111]],

        [[-0.0052, -0.0045,  0.0010],
         [-0.0077, -0.0034, -0.0021],
         [-0.0022, -0.0013,  0.0024]],

        [[ 0.0076,  0.0165,  0.0138],
         [ 0.0093,  0.0220,  0.0158],
         [ 0.0057,  0.0169,  0.0131]]], device='cuda:0')

difference = tensor2 - tensor1

print(difference.pow(2).sum(0).sum(0).sum(0) / difference.shape[0]*difference.shape[1]*difference.shape[2])
